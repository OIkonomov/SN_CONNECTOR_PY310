TYPE = "Alliance"
CREDENTIAL = "NO"
FILTER = "DEVICE_ID"
SILO = "NO"
REALM = "NO"
DATE = "NO"

SQL_REQ = '''
SELECT DISTINCT
    MIN(CLIENT_TIME) AS "CREATED",
    MAX(CLIENT_TIME) AS "LAST_SEEN",
    DATA_CENTER_ID AS "SILO",
    REALM,
    USER_ID AS "DEVICE",
    ABOUT_ID AS "PL_ID",
    FED_ID AS "FED",
    MAX(PROGRESS_INDEX01) AS "LEVEL",
    INGAME_NICKNAME_ACTIVE AS "NAME",
    COUNT(DISTINCT FED_ID) OVER (PARTITION BY DEVICE) AS "TOTAL_ACCOUNTS_USED"
FROM
    "ELEPHANT_DB"."AOV"."PLAYER_CONNECTION_REPORT"
WHERE
    DEVICE = '{filter_value}'
GROUP BY
    SILO,
    REALM,
    DEVICE,
    FED,
    PL_ID,
    NAME
ORDER BY
    LAST_SEEN DESC
LIMIT 10000
;
'''
